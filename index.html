<!DOCTYPE html>
<html lang="ja">
<head>
    <title>NicoVideoClone</title>

    <style type="text/css">
        <!--
            #player-area {
                position: absolute;
                top: 5%;
                left: 25%;
                margin: 0;
                padding: 0;
                width: 640px;
                height: 370px;
            }
            #video-file {
                display: none;
                --width: 640px;
                --height: 360px;
            }
            #comment-1 {
                position: absolute;
                top: 120px;
                left: 320px;
                color: white;
                z-index: 2;
            }
            #play-button {
                position: relative;
                bottom: 0%;
                left: 50%;
            }
            #video-draw-area {
                position: relative;
                z-index: 1;
            }
        -->
    </style>
</head>

<body>
    <script type="text/javascript">
        window.onload = function () {
            // video要素を変数に格納
            videoFile = document.getElementById("video-file");
            // 再生ボタン初期設定
            playButton = document.getElementById("play-button");
            isPlaying = false;
            playButtonText = "▷";
            playButton.value = playButtonText;
        }
        // 再生ボタン押下
        function pushPlayVideoButton() {
            if (!isPlaying) {
                videoFile.play();
                document.getElementById("play-button").value = "II";
                isPlaying = true;
                commentTimer = setInterval(moveComment, 100);
                canvasTimer = setInterval(drawVideoToCanvas, 1000/60);
            } else {
                videoFile.pause();
                document.getElementById("play-button").value = "▷";
                isPlaying = false;
                clearInterval(commentTimer);
                clearInterval(canvasTimer);
            }
        }
        // コメント動作
        function moveComment() {
            var commentPositionX = parseInt(window.getComputedStyle(document.getElementById("comment-1")).getPropertyValue('left'));
            commentPositionX = (commentPositionX - 10) + "px";
            document.getElementById("comment-1").style.left = commentPositionX;

        }
        // video要素をcanvasに描画
        function drawVideoToCanvas() {
            videoDrawArea = document.getElementById("video-draw-area");
            videoDrawArea.getContext("2d").drawImage(videoFile, 0, 0, videoFile.videoWidth, videoFile.videoHeight, 0, 0, 640, 360);
        }
    </script>

    <div id = "player-area">
        <video id="video-file" src="video.mp4"></video>
        <div id ="comment-data">
            <div id ="comment-1">ニコニコネット超会議</div>
        </div>
        <canvas id="video-draw-area" width="640px" height="360px"></canvas>
        <input id="play-button" type="button" onClick=pushPlayVideoButton() />
    </div>
</body>


</html>
